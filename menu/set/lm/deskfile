#!/bin/bash
# ------------------------------------------------------------------------------
# | sea's Script Tools: The 3rd Generation
# | File Description:	Handle Login Manager things - Desktop file
	script_version=0.5
# | Author:             Simon A. Erat (sea) <erat.simon AT gmail.com>
# | Created (y.m.d):    2012.05.30
# | Changed:            2013.05.04
# | License:            GPL v3
# | Modified By:        
# | Resource:           
# | Special Thanks: 
# ------------------------------------------------------------------------------
# | Title
    deskfile=/etc/sysconfig/desktop
    sT "Create the $(basename $deskfile) file in $(dirname $deskfile) ($script_version)"
    test ! $UID -eq 0 && \
    	sT " " && sT " ---- Requires root rights to apply changes! ----" && sT " "
# |
# | Variables
	des=""
	lms=""
	tdes=$(ls $stDir/Configuration_Lists/inst|grep "de\.")
	tlms=$(ls $SEA_CLI_DIR/set/lm)

	for t in $tdes;do des="$des ${t:3}";done
	for t in $tlms;do test -d $SEA_CLI_DIR/set/lm/$t && lms="$lms $t";done
# |
# | One liners
	sE "Please select the login manager you want to use:"
	select LM in $lms;do break;done

	sE "Please select the default DE you want to use:"
	select DE in $des;do break;done
# | 
# | Display
	sE
	sE "Selected login manager:" 	   "$LM"
	sE "Selected desktop environment:" "$DE"
	if ask "Are these values correct?"
	then	case $LM in
		slim)	LM=$(which slim)	;;
		lxdm)	LM=$(which lxdm)	;;
		gdm)	LM=$(which gdm)		;;
		esac

		case $DE in
		lxde)	DE=$(which startlxde)	;;
		*)	DE=$(which $DE)		;;
		esac
		
		echo "# /etc/sysconfig/desktop : File generated by sea Script Tools ($stVer)" > $deskfile
		echo $(cat $stDir/Script-Core/Templates/desktop|grep DIS)$LM >> $deskfile
		echo $(cat $stDir/Script-Core/Templates/desktop|grep PREF)$DE >> $deskfile && \
			sE "Successfully changed $deskfile" "$SUCCESS" || \
			sE "Could not change $deskfile" "$FAILURE"
	else	sE "Didnt change anything."
	fi
	sT "Content of $deskfile"
	cat $deskfile
	
